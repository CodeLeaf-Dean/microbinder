class MicroBinder{constructor(){this.t=1,this.i={},this.s=!1,this.h=[],this.bindObjects=[],this.binders={text:(t,r,e)=>mb.bind(r,e,r=>t.innerText=r),html:(t,r,e)=>mb.bind(r,e,r=>t.innerHTML=r),value:(t,r,e)=>{mb.bind(r,e,r=>t.value=r),t.addEventListener("change",t=>mb.setValue(r,e,t.target.value))},checked:(t,r,e)=>{mb.bind(r,e,r=>{r?t.setAttribute("checked",""):t.removeAttribute("checked","")}),t.addEventListener("change",t=>mb.setValue(r,e,t.target.checked))},css:(t,r,e)=>{for(const i in e){const n=e[i];mb.bind(r,n,r=>r?t.classList.add(i):t.classList.remove(i))}},attr:(t,r,e)=>{for(const i in e){const n=e[i];mb.bind(r,n,r=>t.setAttribute(i,r))}},style:(t,r,e)=>{for(const i in e){const n=e[i];mb.bind(r,n,r=>t.style[i]=r)}},visible:(t,r,e)=>mb.bind(r,e,r=>t.style.display=r?null:"none"),click:(t,r,e)=>t.addEventListener("click",i=>e.call(r,t)),foreach:(t,r,e)=>{var i=t.innerHTML;t.innerHTML="";var n=e.call(r);t.bindArray=[],n.proxyHandler.l.push(t);var s=(e,n)=>{var s=mb.render(e,t,i,n,r);null==t.bindArray[n]&&(t.bindArray[n]=[]),t.bindArray[n]=s};return t.insertFunc=s,n.forEach(s),!0}}}bind(t,r,e){this.s=!0,this.h=[];var i=r.call(t);if(this.s=!1,this.h.length>0){var n=this.t++;this.i[n]=[],this.h.forEach(t=>t.handler.o(t.prop,r,e,n))}e(i)}setValue(t,r,e){this.u=!0,this.v=[];r.call(t);this.u=!1,this.v.length>0&&this.v.pop()(e)}m(t,r,e){var i=!1;for(var n in e)i=mb.binders[n](t,r,e[n])|i;return i}p(t){for(var r=t;null==r.bindIndex;)r=r.parentNode;return r.bindIndex}A(t,r,e,i,n){var s=!1;if(1==r.nodeType&&r.hasAttribute("bind")){var a=r.getAttribute("bind");if(r.removeAttribute("bind"),null!=a&&a.length>0){var h=parseInt(a);if(isNaN(h)){l=new Function("$element,$data,$index,$parent,$root","return "+a+";").call(t,r,t,()=>this.p(r),i,n);s=this.m(r,t,l)}else{var l=this.bindObjects[h].call(t,r,t,()=>this.p(r),i,n);s=this.m(r,t,l)}}}s||r.childNodes.forEach(r=>this.A(t,r,e,i,n))}render(t,r,e,i,n){var s="object"!=typeof t||t.isProxy?t:new Proxy(t,new ObjectHandler),a=null;if("string"==typeof e){var h=document.getElementById(e);if(null!=h){if(h.hasAttribute("src"))return void loadExternalTemplate(h,t,r,i,n);a=h.content?h.content.cloneNode(!0):document.createRange().createContextualFragment(h.innerHTML)}else a=document.createRange().createContextualFragment(e)}else a=e;if(null==a&&(a=r||document.body),null!=i)for(let t=0;t<a.childNodes.length;t++)a.childNodes[t].bindIndex=i;this.A(s,a,i,n,r||document.body);var l=[];if(null!=e){var c=r.bindArray;if(null==i||i>=c.length){var o=r.childNodes.length;r.appendChild(a);for(let t=o;t<r.childNodes.length;t++)l.push(r.childNodes[t])}else if(0==i){var u=r.childNodes.length;r.prepend(a);var f=r.childNodes.length-u;for(let t=0;t<f;t++)l.push(r.childNodes[t])}else for(var v=(c=r.bindArray[i-1])[c.length-1],b=v.nextSibling,d=(r.insertBefore(a,b),v.nextSibling);d!=b;)l.push(d),d=d.nextSibling}return null==i?s:l}}var mb=new MicroBinder;class ObjectHandler{constructor(){this.g=this,this.j={},this.H={}}o(t,r,e,i){null==this.H[t]&&(this.H[t]=[]);var n=this.H[t],s={_:n,O:r,k:e,$:i};n.push(s),mb.i[i].push(s)}D(t,r){if(null!=this.H[t]){var e=[];this.H[t].forEach(t=>{mb.bind(r,t.O,t.k),e.push(t.$)}),e.forEach(t=>{mb.i[t].forEach(t=>t._.splice(t._.indexOf(t),1)),delete mb.i[t]})}}get(t,r,e){if("proxyHandler"===r)return this;if("isProxy"===r)return!0;if("proxyObject"===r)return t;var i=Reflect.get(t,r,e);return mb.s&&mb.h.push({handler:this,prop:r}),this instanceof DateHandler||!mb.u||mb.v.push(t=>e[r]=t),"object"==typeof i?(null==this.j[r]&&(this.j[r]=new Proxy(i,"[object Date]"===Object.prototype.toString.call(i)?new DateHandler:Array.isArray(i)?new ArrayHandler:new ObjectHandler)),this.j[r]):i}set(t,r,e,i){e.isProxy&&(e=e.proxyObject);var n=Reflect.set(t,r,e,i);if("object"==typeof e){var s=this.j[r];if(delete this.j[r],Array.isArray(e)){s.length=0;var a=i[r];a.proxyHandler.l=currentArrayProxy.proxyHandler.l,a.proxyHandler.F(0,0,e.length,e)}}return this.D(r,i),n}}class DateHandler extends ObjectHandler{constructor(){super()}get(t,r,e){var i=super.get(t,r,e);return"function"==typeof i?function(n){var s=t,a=i.apply(t,arguments);return t!=s&&this.D(r,e),a}.bind(this):i}}class ArrayHandler extends ObjectHandler{constructor(){super(),this.j=[],this.l=[]}F(t,r,e,i){var n=[];n[0]=t,n[1]=r;for(let t=0;t<e;t++)n[t+2]=null;Array.prototype.splice.apply(this.j,n),this.l.forEach(i=>{for(let e=0;e<r;e++)i.bindArray[t+e].forEach(t=>t.remove());var n=[];n[0]=t,n[1]=r;for(let t=0;t<e;t++)n[t+2]=[];Array.prototype.splice.apply(i.bindArray,n)});for(let r=t;r<t+e;r++)this.l.forEach(t=>{t.insertFunc(i[r],r)});this.l.forEach(r=>{for(let i=t+e;i<r.bindArray.length;i++)r.bindArray[i].forEach(t=>t.bindIndex=i)})}get(t,r,e){var i=super.get(t,r,e);return"function"==typeof i?"splice"===r?function(r){var i=arguments[0];i>this.length&&(i=this.length),i<-this.length&&(i=0),i<0&&(i=this.length+i+1);var n=1==arguments.length?this.length-i:arguments[1];n>this.length-i&&(n=this.length-i);var s=Array.prototype.splice.apply(t,arguments);return this.F(i,n,arguments.length-2,e),s}.bind(this):"push"===r?function(r){var i=t.length,n=Array.prototype.push.apply(t,arguments);return this.F(i,0,arguments.length,e),n}.bind(this):"pop"===r?function(){if(0!=t.length){var r=t.length,i=Array.prototype.pop.apply(t,arguments);return this.F(r-1,1,0,e),i}}.bind(this):"shift"===r?function(){if(0!=t.length){var r=Array.prototype.shift.apply(t,arguments);return this.F(0,1,0,e),r}}.bind(this):"unshift"===r?function(r){var i=Array.prototype.unshift.apply(t,arguments);return this.F(0,0,1,e),i}.bind(this):"reverse"===r||"sort"==r?function(i){var n=Array.prototype[r].apply(t,arguments);return this.F(0,t.length,t.length,e),n}.bind(this):"fill"===r?function(r){var i=arguments[1]||0,n=arguments[2]||t.length;i<0&&(i=ob.length+i),n<0&&(n=ob.length+n);var s=Array.prototype.fill.apply(t,arguments);return this.F(i,n,n-i,e),s}.bind(this):i.bind(e):i}set(t,r,e,i){var n=t.length,s=Reflect.set(t,r,e,i);return"length"===r?n>e&&this.F(e,n-e):t.length===n?this.F(parseInt(r),1,1,t):this.F(parseInt(r),0,1,t),s}}