class ObjectHandler{constructor(e){this.mb=e,this._handler=this,this._childProxies={},this._subscribers={},this.parentProxy=null}_subscribe(e,t,n,r){if("constructor"==e)return null;null==this._subscribers[e]&&(this._subscribers[e]=[]);var i=this._subscribers[e];if(!Array.isArray(i))return null;var s={_eventFunc:t,_subscription:()=>this._subscribers[e],_triggerFunc:n,_bindingId:r};return i.push(s),s}_notifySubscribers(e,t,n,r,i,s){if(null!=this._subscribers[e])for(var a=this._subscribers[e].length-1;a>=0;a--)this._subscribers[e][a]._eventFunc(n,t,r,i,s)}get(e,t,n){if("_proxyHandler"===t)return this;if("_parentProxy"===t)return this.parentProxy;if("_isProxy"===t)return!0;if("_proxyObject"===t)return e;if("_subscribe"===t)return this._subscribe.bind(this);var r=Reflect.get(e,t,n);if(this.mb._calculatingDependancies&&(this.mb._calculatedDependancies.find((e=>e.handler==this&&e.prop==t))||this.mb._calculatedDependancies.push({handler:this,prop:t})),this.mb._settingValue&&this.mb._setStack.push((e=>n[t]=e)),null!=r&&"object"==typeof r){if(null==this._childProxies[t]){var i=this.mb.wrap(r);i._proxyHandler.parentProxy=n,i._proxyHandler.parentProp=t,this._childProxies[t]=i}return this._childProxies[t]}return r}set(e,t,n,r){var i=!1;null!=n&&n._isProxy&&(this._childProxies[t]=n,n=n._proxyObject,i=!0);var s=e[t],a=Reflect.set(e,t,n,r);if("object"==typeof n&&!i){var o=this._childProxies[t];if(delete this._childProxies[t],Array.isArray(n)){var l=r[t];o&&(o.length=0,l._proxyHandler._bindElements=o._proxyHandler._bindElements),l._proxyHandler._handleSplice(0,0,n.length,l)}}return this._notifySubscribers(t,s,n),a}}class DateHandler extends ObjectHandler{constructor(e){super(e)}get(e,t,n){var r=super.get(e,t,n);return"function"==typeof r?function(t){var n=new Date(e.valueOf()),i=r.apply(e,arguments);return e!=n&&this.parentProxy._proxyHandler._notifySubscribers(this.parentProp,n,e),i}.bind(this):r}set(e,t,n,r){var i=this.mb._settingValue;this.mb._settingValue=!1;var s=super.set(e,t,n,r);return this.mb._settingValue=i,s}}class BindingContext{constructor(e,t,n,r){this.mb=e,this.$data=t,this.$parentContext=r,this._proxy=new Proxy({$index:n},new ObjectHandler(e)),this.bindings=[]}get $parent(){return this.$parentContext.$data}get $index(){return this.mb._calculatingDependancies&&this.mb._calculatedDependancies.push({handler:this._proxy.proxyHandler,prop:"$index"}),this._proxy.$index}set $index(e){this._proxy.$index=e}bind(e,t,n,r,i,s,a){var o=this.mb.bind(e,t,n,r,i,s,a);return this.bindings.push(o),o}createSiblingContext(){return new BindingContext(this.mb,this.$data,this.$index,this.$parentContext)}createChildContext(e,t){return new BindingContext(this.mb,e,t,this)}getPreviousElement(e){if(e.getPreviousSibling){var t=e.getPreviousSibling();if(t&&t.getPreviousSibling){if(t.bindArray&&0!=t.bindArray.length&&0!=t.bindArray[t.bindArray.length-1].length){var n=t.bindArray[t.bindArray.length-1];return n[n.length-1]}return this.getPreviousElement(t)}return t}}commitElement(){if(this.element.getPreviousSibling){var e=this.getPreviousElement(this.element);if(null==e)for(let e=this.element.children.length-1;e>=0;e--)this.element.parent.insertAdjacentElement("afterbegin",this.element.children[e]);else e.after(this.element)}}clearElement(e){if(this.element instanceof DocumentFragment){var t=this.element.bindArray[e];this.clearBindArray(t)}else this.element.innerHTML=""}clearBindArray(e){for(let n=0;n<e.length;n++)if(e[n]instanceof DocumentFragment){e[n].$context.clearBindings();var t=e[n].bindArray;for(let e=0;e<t.length;e++)this.clearBindArray(t[e])}else e[n].remove();e.length=0}clearBindings(){this.bindings.forEach((e=>{e.unbind()})),this.bindings=[]}}class ArrayHandler extends ObjectHandler{constructor(e,t,n){super(e),this._childProxies=[],this._childContexts=[],this._bindElements=[]}_handleSplice(e,t,n,r){var i=[];i[0]=e,i[1]=t;for(let e=0;e<n;e++)i[e+2]=null;Array.prototype.splice.apply(this._childProxies,i),this.parentProxy._proxyHandler._notifySubscribers(this.parentProp,this.parentProxy,this.parentProxy,e,t,n)}get(e,t,n){var r=super.get(e,t,n);return"childContexts"===t?this._childContexts:"function"==typeof r?"splice"===t?function(t){var r=arguments[0];r>e.length&&(r=e.length),r<-e.length&&(r=0),r<0&&(r=e.length+r+1);var i=1==arguments.length?e.length-r:arguments[1];i>e.length-r&&(i=e.length-r);var s=Array.prototype.splice.apply(e,arguments);return this._handleSplice(r,i,arguments.length-2,n),s}.bind(this):"push"===t?function(t){var r=e.length,i=Array.prototype.push.apply(e,arguments);return this._handleSplice(r,0,arguments.length,n),i}.bind(this):"pop"===t?function(){if(0!=e.length){var t=e.length,r=Array.prototype.pop.apply(e,arguments);return this._handleSplice(t-1,1,0,n),r}}.bind(this):"shift"===t?function(){if(0!=e.length){var t=Array.prototype.shift.apply(e,arguments);return this._handleSplice(0,1,0,n),t}}.bind(this):"unshift"===t?function(t){var r=Array.prototype.unshift.apply(e,arguments);return this._handleSplice(0,0,1,n),r}.bind(this):"reverse"===t||"sort"==t?function(r){var i=Array.prototype[t].apply(e,arguments);return this._handleSplice(0,e.length,e.length,n),i}.bind(this):"fill"===t?function(t){var r=arguments[1]||0,i=arguments[2]||e.length;r<0&&(r=ob.length+r),i<0&&(i=ob.length+i);var s=Array.prototype.fill.apply(e,arguments);return this._handleSplice(r,i,i-r,n),s}.bind(this):"indexOf"===t?function(t){arguments[0]=this.mb.unwrap(arguments[0]);var n=Array.prototype.indexOf.apply(e,arguments);return n}.bind(this):r.bind(n):r}set(e,t,n,r){var i=e.length,s=Reflect.set(e,t,n,r);return"length"===t?i>n&&this._handleSplice(n,i-n):e.length===i?this._handleSplice(parseInt(t),1,1,e):this._handleSplice(parseInt(t),0,1,e),s}}class MicroBinderCore{constructor(){this._nextBindingId=1,this._bindings={},this._calculatingDependancies=!1,this._calculatedDependancies=[],this.bindObjects=[],this.bindObjectCount=-1}wrap(e){if(e._isProxy)return e;if(null!=e.___proxy)return e.___proxy;var t="[object Date]"===Object.prototype.toString.call(e)?new DateHandler(this):Array.isArray(e)?new ArrayHandler(this,null,e):new ObjectHandler(this),n=new Proxy(e,t);return e.___proxy=n,n}unwrap(e){return e._isProxy?e._proxyObject:e}bind(e,t,n,r,i,s,a,o){this._calculatingDependancies=!0,this._calculatedDependancies=[];var l=e.call(null==n?null:n.$data);this._calculatingDependancies=!1;var u=o;return this._calculatedDependancies.length>0&&(null==o&&(u=this._nextBindingId++),this._bindings[u]=[],this._calculatedDependancies.forEach((r=>{if(r.handler){var i=r.handler._subscribe(r.prop,((r,i,s,a,o)=>{this._bindings[u].forEach((e=>e._subscription().splice(e._subscription().indexOf(e),1))),delete this._bindings[u],this.bind(e,t,n,i,s,a,o,u)}),e,u);i&&this._bindings[u].push(i)}}))),t(l,r,i,s,a),{unbind:()=>{this._calculatedDependancies.length>0&&this._bindings[u]&&(this._bindings[u].forEach((e=>e._subscription().splice(e._subscription().indexOf(e),1))),delete this._bindings[u])}}}computed(e,t){var n=this,r=n.wrap(t),i=n.wrap({value:void 0});return n.bind(e.bind(r),function(e){i.value!=e&&(i.value=e)}.bind(r)),function(){return i.value}}}const intToCharMap="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");function encode(e){if(0<=e&&e<intToCharMap.length)return intToCharMap[e];throw new TypeError("Must be between 0 and 63: "+e)}const VLQ_BASE_SHIFT=5,VLQ_BASE=32,VLQ_BASE_MASK=31,VLQ_CONTINUATION_BIT=32;function toVLQSigned(e){return e<0?1+(-e<<1):0+(e<<1)}function encode$1(e){let t,n="",r=toVLQSigned(e);do{t=31&r,r>>>=5,r>0&&(t|=32),n+=encode(t)}while(r>0);return n}var exports$1={};function getArg(e,t,n){if(t in e)return e[t];if(3===arguments.length)return n;throw new Error('"'+t+'" is a required argument.')}exports$1.getArg=getArg;const supportsNullProto=!("__proto__"in Object.create(null));function identity(e){return e}function toSetString(e){return isProtoString(e)?"$"+e:e}function fromSetString(e){return isProtoString(e)?e.slice(1):e}function isProtoString(e){if(!e)return!1;const t=e.length;if(t<9)return!1;if(95!==e.charCodeAt(t-1)||95!==e.charCodeAt(t-2)||111!==e.charCodeAt(t-3)||116!==e.charCodeAt(t-4)||111!==e.charCodeAt(t-5)||114!==e.charCodeAt(t-6)||112!==e.charCodeAt(t-7)||95!==e.charCodeAt(t-8)||95!==e.charCodeAt(t-9))return!1;for(let n=t-10;n>=0;n--)if(36!==e.charCodeAt(n))return!1;return!0}function strcmp(e,t){return e===t?0:null===e?1:null===t?-1:e>t?1:-1}function compareByGeneratedPositionsInflated(e,t){let n=e.generatedLine-t.generatedLine;return 0!==n?n:(n=e.generatedColumn-t.generatedColumn,0!==n?n:(n=strcmp(e.source,t.source),0!==n?n:(n=e.originalLine-t.originalLine,0!==n?n:(n=e.originalColumn-t.originalColumn,0!==n?n:strcmp(e.name,t.name)))))}function parseSourceMapInput(e){return JSON.parse(e.replace(/^\)]}'[^\n]*\n/,""))}exports$1.toSetString=supportsNullProto?identity:toSetString,exports$1.fromSetString=supportsNullProto?identity:fromSetString,exports$1.compareByGeneratedPositionsInflated=compareByGeneratedPositionsInflated,exports$1.parseSourceMapInput=parseSourceMapInput;const PROTOCOL="http:",PROTOCOL_AND_HOST="http://host";function createSafeHandler(e){return t=>{const n=getURLType(t),r=buildSafeBase(t),i=new URL(t,r);e(i);const s=i.toString();return"absolute"===n?s:"scheme-relative"===n?s.slice("http:".length):"path-absolute"===n?s.slice("http://host".length):computeRelativeURL(r,s)}}function withBase(e,t){return new URL(e,t).toString()}function buildUniqueSegment(e,t){let n=0;for(;;){const r=e+n++;if(-1===t.indexOf(r))return r}}function buildSafeBase(e){const t=e.split("..").length-1,n=buildUniqueSegment("p",e);let r="http://host/";for(let e=0;e<t;e++)r+=`${n}/`;return r}const ABSOLUTE_SCHEME=/^[A-Za-z0-9\+\-\.]+:/;function getURLType(e){return"/"===e[0]?"/"===e[1]?"scheme-relative":"path-absolute":ABSOLUTE_SCHEME.test(e)?"absolute":"path-relative"}function computeRelativeURL(e,t){"string"==typeof e&&(e=new URL(e)),"string"==typeof t&&(t=new URL(t));const n=t.pathname.split("/"),r=e.pathname.split("/");for(r.length>0&&!r[r.length-1]&&r.pop();n.length>0&&r.length>0&&n[0]===r[0];)n.shift(),r.shift();return r.map((()=>"..")).concat(n).join("/")+t.search+t.hash}const ensureDirectory=createSafeHandler((e=>{e.pathname=e.pathname.replace(/\/?$/,"/")})),trimFilename=createSafeHandler((e=>{e.href=new URL(".",e.toString()).toString()})),normalize=createSafeHandler((e=>{}));function join(e,t){const n=getURLType(t),r=getURLType(e);if(e=ensureDirectory(e),"absolute"===n)return withBase(t,void 0);if("absolute"===r)return withBase(t,e);if("scheme-relative"===n)return normalize(t);if("scheme-relative"===r)return withBase(t,withBase(e,"http://host")).slice("http:".length);if("path-absolute"===n)return normalize(t);if("path-absolute"===r)return withBase(t,withBase(e,"http://host")).slice("http://host".length);const i=buildSafeBase(t+e);return computeRelativeURL(i,withBase(t,withBase(e,i)))}function relative(e,t){const n=relativeIfPossible(e,t);return"string"==typeof n?n:normalize(t)}function relativeIfPossible(e,t){if(getURLType(e)!==getURLType(t))return null;const n=buildSafeBase(e+t),r=new URL(e,n),i=new URL(t,n);try{new URL("",i.toString())}catch(e){return null}return i.protocol!==r.protocol||i.user!==r.user||i.password!==r.password||i.hostname!==r.hostname||i.port!==r.port?null:computeRelativeURL(r,i)}function computeSourceURL(e,t,n){e&&"path-absolute"===getURLType(t)&&(t=t.replace(/^\//,""));let r=normalize(t||"");return e&&(r=join(e,r)),n&&(r=join(trimFilename(n),r)),r}exports$1.normalize=normalize,exports$1.join=join,exports$1.relative=relative,exports$1.computeSourceURL=computeSourceURL;class ArraySet{constructor(){this._array=[],this._set=new Map}static fromArray(e,t){const n=new ArraySet;for(let r=0,i=e.length;r<i;r++)n.add(e[r],t);return n}size(){return this._set.size}add(e,t){const n=this.has(e),r=this._array.length;n&&!t||this._array.push(e),n||this._set.set(e,r)}has(e){return this._set.has(e)}indexOf(e){const t=this._set.get(e);if(t>=0)return t;throw new Error('"'+e+'" is not in the set.')}at(e){if(e>=0&&e<this._array.length)return this._array[e];throw new Error("No element indexed by "+e)}toArray(){return this._array.slice()}}function generatedPositionAfter(e,t){const n=e.generatedLine,r=t.generatedLine,i=e.generatedColumn,s=t.generatedColumn;return r>n||r==n&&s>=i||exports$1.compareByGeneratedPositionsInflated(e,t)<=0}class MappingList{constructor(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}unsortedForEach(e,t){this._array.forEach(e,t)}add(e){generatedPositionAfter(this._last,e)?(this._last=e,this._array.push(e)):(this._sorted=!1,this._array.push(e))}toArray(){return this._sorted||(this._array.sort(exports$1.compareByGeneratedPositionsInflated),this._sorted=!0),this._array}}class SourceMapGenerator{constructor(e){e||(e={}),this._file=exports$1.getArg(e,"file",null),this._sourceRoot=exports$1.getArg(e,"sourceRoot",null),this._skipValidation=exports$1.getArg(e,"skipValidation",!1),this._sources=new ArraySet,this._names=new ArraySet,this._mappings=new MappingList,this._sourcesContents=null}addMapping(e){const t=exports$1.getArg(e,"generated"),n=exports$1.getArg(e,"original",null);let r=exports$1.getArg(e,"source",null),i=exports$1.getArg(e,"name",null);this._skipValidation||this._validateMapping(t,n,r,i),null!=r&&(r=String(r),this._sources.has(r)||this._sources.add(r)),null!=i&&(i=String(i),this._names.has(i)||this._names.add(i)),this._mappings.add({generatedLine:t.line,generatedColumn:t.column,originalLine:n&&n.line,originalColumn:n&&n.column,source:r,name:i})}setSourceContent(e,t){let n=e;null!=this._sourceRoot&&(n=exports$1.relative(this._sourceRoot,n)),null!=t?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[exports$1.toSetString(n)]=t):this._sourcesContents&&(delete this._sourcesContents[exports$1.toSetString(n)],0===Object.keys(this._sourcesContents).length&&(this._sourcesContents=null))}_validateMapping(e,t,n,r){if(t&&"number"!=typeof t.line&&"number"!=typeof t.column)throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(e&&"line"in e&&"column"in e&&e.line>0&&e.column>=0&&!t&&!n&&!r);else if(!(e&&"line"in e&&"column"in e&&t&&"line"in t&&"column"in t&&e.line>0&&e.column>=0&&t.line>0&&t.column>=0&&n))throw new Error("Invalid mapping: "+JSON.stringify({generated:e,source:n,original:t,name:r}))}_serializeMappings(){let e,t,n,r,i=0,s=1,a=0,o=0,l=0,u=0,c="";const h=this._mappings.toArray();for(let d=0,p=h.length;d<p;d++){if(t=h[d],e="",t.generatedLine!==s)for(i=0;t.generatedLine!==s;)e+=";",s++;else if(d>0){if(!exports$1.compareByGeneratedPositionsInflated(t,h[d-1]))continue;e+=","}e+=encode$1(t.generatedColumn-i),i=t.generatedColumn,null!=t.source&&(r=this._sources.indexOf(t.source),e+=encode$1(r-u),u=r,e+=encode$1(t.originalLine-1-o),o=t.originalLine-1,e+=encode$1(t.originalColumn-a),a=t.originalColumn,null!=t.name&&(n=this._names.indexOf(t.name),e+=encode$1(n-l),l=n)),c+=e}return c}_generateSourcesContent(e,t){return e.map((function(e){if(!this._sourcesContents)return null;null!=t&&(e=exports$1.relative(t,e));const n=exports$1.toSetString(e);return Object.prototype.hasOwnProperty.call(this._sourcesContents,n)?this._sourcesContents[n]:null}),this)}toJSON(){const e={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return null!=this._file&&(e.file=this._file),null!=this._sourceRoot&&(e.sourceRoot=this._sourceRoot),this._sourcesContents&&(e.sourcesContent=this._generateSourcesContent(e.sources,e.sourceRoot)),e}toString(){return JSON.stringify(this.toJSON())}}SourceMapGenerator.prototype._version=3;class FuncGenerator{constructor(e){this.defaultBinders=[{match:"input[type=text]",binder:"textInput"},{match:"ul",binder:"foreach"},{match:"button",binder:"click"}],this.mb=e}generateRootInsertFunc(e){return new Promise(((t,n)=>{var r=null,i="unnamed-template";if("string"==typeof e){var s=document.getElementById(e);if(null!=s){if("LINK"==s.nodeName){i=s.href;var a=new XMLHttpRequest;return a.open("GET",s.href),a.onreadystatechange=function(){a.readyState===XMLHttpRequest.DONE&&200===a.status&&t(this.buildInsertFuncWithSourceMap(a.responseText,i))}.bind(this),void a.send()}i=e,r=s.content?s.content.cloneNode(!0):document.createRange().createContextualFragment(s.innerHTML)}else{var o=document.createElement("template");o.innerHTML=e,r=o.content}}else r=e;t(null==r?this.buildInsertFuncWithSourceMap(document.body.childNodes,i,!0):this.buildInsertFuncWithSourceMap(r,i))}))}buildInsertFuncWithSourceMap(e,t,n){var r,i={root:[],offset:[],maps:[]};if("[object NodeList]"===e.toString())r=Array.prototype.reduce.call(e,(function(e,t){return e+(t.outerHTML||t.nodeValue)}),"");else if("string"==typeof e){var s=document.createElement("template");s.innerHTML=e,e=s.content,r=s.innerHTML}else{var a=document.createElement("div");a.appendChild(e.cloneNode(!0)),r=a.innerHTML.replace(/&amp;/g,"&")}var o=[];this.mb.bindObjectCount++,this.buildInsertFuncBody(o,[],e,0,r,i,n);var l=new SourceMapGenerator({file:t+".template.map"});l.setSourceContent(t+".template.map",r);for(let e=0;e<i.maps.length;e++){var u=i.maps[e];l.addMapping({generated:{line:u.newLine,column:u.newColumn},source:t+".template.map",original:{line:u.originalLine,column:u.originalColumn},name:u.name})}return o.push("\n"),o.push("//# sourceMappingURL=data:text/plain;base64,"),o.push(btoa(l.toString())),o.push("\n"),o.push("//# sourceURL="+t+".template.js"),o.push("\n"),new Function("$context,n0,$funcElement",o.join(""))}buildInsertFuncBody(e,t,n,r,i,s,a,o){return e.maxDepth=0,e.push("\nvar $mb = $context.mb;\n"),e.push("\nvar t = null;\n"),e.push("\nvar prev = null;\n"),e.push("\nvar $bindingContext = null;\n"),e.push("var renderedElements = [];\n"),"[object NodeList]"===n.toString()?o?n.forEach((n=>this.executeBindingsFuncVisit(n,e,t,1,r,i,s,a))):n.forEach((n=>this.buildInsertFuncVisit(n,e,t,1,r,i,s,a))):o?this.executeBindingsFuncVisit(n,e,t,0,r,i,s,a):this.buildInsertFuncVisit(n,e,t,0,r,i,s,a),e.push("if($funcElement){\n"),e.push("    if(!$funcElement.bindArray)$funcElement.bindArray=[];\n"),e.push("    $funcElement.bindArray[$context.$index || 0] = renderedElements;\n"),e.push("}\n"),e}executeBindingsFuncVisit(e,t,n,r,i,s,a,o){if(1==e.nodeType)e.getAttribute("bind")}buildInsertFuncVisit(e,t,n,r,i,s,a,o){var l=!1;if(1==e.nodeType){if("VIRTUAL"==e.nodeName?(t.push("prev = ","n",r,";\n"),t.push(r>t.maxDepth?"var ":"","n",r," = document.createDocumentFragment();\n"),t.push("n",r,".prev = prev;\n"),t.push("n",r,".parent = ","n",r-1,";\n"),t.push("n",r,".getPreviousSibling = function(){return this.prev};\n")):t.push(r>t.maxDepth?"var ":"","n",r," = document.createElement('",e.nodeName,"');\n"),r>t.maxDepth&&(t.maxDepth=r),e.hasAttributes()){var u=e.attributes;for(let C=u.length-1;C>=0;C--){const A=u[C].name;var c=u[C].value;if("bind"==A){if(-1==c.indexOf(":"))c="{"+this.getDefaultBinder(e)+":"+c+"}";c.startsWith("{")||(c="{"+c+"}");var h={$data:new FunctionTester,$index:()=>0},d=new Function("$context","with($context){with($data){ return "+c+"}}").call(h.$data,h);for(const e in d)c=c.replace(new RegExp(e+"s*:"),e+": ()=> ");l=Object.keys(d).some((e=>Object.keys(this.mb.subBinders).indexOf(e)>=0));var p=i;l&&(this.mb.bindObjectCount++,p=this.mb.bindObjectCount,t.push("$mb.bindObjects["+p+"] = (function anonymous($context,n0,$funcElement) {"),this.buildInsertFuncBody(t,n,e.childNodes,p,s,a,o),t.push("})\n"),t.push("// ========================"),t.push("\n")),t.push("{");var g="";if(s){var m=e.outerHTML.replace(/&amp;/g,"&");for(const e in d){var f,b,_=8+c.match(new RegExp(e+"s*:")).index+e.length+6,y=0,v=s.substr(0,s.indexOf(m));b=(v.match(/\n/g)||[]).length+1,f=t.join("").match(/\n/g).length+5;var x=v.split("\n").slice(-1)[0].length;y=x+(m.indexOf("bind=")+6);var S=m.match(new RegExp(e+"s*:"));S&&(y=x+S.index+e.length+1),a.maps.push({newLine:f,newColumn:_,originalLine:b,originalColumn:y,name:e}),g=g+"line: "+f+", column: "+_+", originalline: "+b+", orignalColumn: "+y}}t.push("$bindingContext = $context.createSiblingContext();\n"),t.push("$mb.executeBinding(n",r,", $bindingContext, (function(){with($bindingContext){with($data??{}){\nreturn ",c,"// "+g,"\n}}}).call($bindingContext.$data), ",p,");\n"),e.nodeName,t.push("}\n")}else"class"==A?t.push("n",r,".classList.add('",c,"');\n"):t.push("n",r,".setAttribute('",A,"', '",c,"');\n")}}t.push("n",r-1,".appendChild(n",r,");\n\n"),r-1==0&&t.push("renderedElements.push(n",r,");\n\n")}else 3==e.nodeType&&(t.push("t = document.createTextNode(`",e.nodeValue.replace(/\\/g,"\\\\"),"`);\n"),t.push("n",r-1,".appendChild(t);\n\n"),r-1==0&&t.push("renderedElements.push(t);\n\n"));l||e.childNodes.forEach((e=>this.buildInsertFuncVisit(e,t,n,r+1,i,s,a,o)))}getDefaultBinder(e){for(let t=0;t<this.defaultBinders.length;t++){const n=this.defaultBinders[t];if(e.matches(n.match))return n.binder}return"text"}}function FunctionTester(){return this.has=function(e,t){return!0},this.get=function(e,t,n){return t==Symbol.unscopables?{}:t==Symbol.toPrimitive||"toString"==t?()=>"":new FunctionTester},this.set=function(e,t,n,r){},this.apply=function(e,t,n){return new FunctionTester},new Proxy((function(){}),this)}function ForBinder(e,t){e.bind(t,((t,n)=>{var r=e.element,i=document.createDocumentFragment(),s=t-(n||0);if(s>0){for(let t=0;t<s;t++)e.insertFunc.call(this,e.createChildContext(e.$data,t+(n||0)),i,r);if(null==n)r.appendChild(i);else{var a=r.bindArray[n-1];a[a.length-1].after(i)}}if(s<0)for(let r=n-1;r>=t;r--)e.clearElement(r)}),e)}function ForEachBinder(e,t){e.bind(t,((t,n,r,i,s)=>{var a=e.element;if(null==n){var o=document.createDocumentFragment();for(let n=0;n<t.length;n++){const r=t[n];e.insertFunc.call(this,e.createChildContext(r,n),o,a)}a.appendChild(o),e.commitElement()}if(i>0){for(let t=0;t<i;t++)e.clearElement(r+t);var l=[];l[0]=r,l[1]=i;for(let e=0;e<s;e++)l[e+2]=[];Array.prototype.splice.apply(a.bindArray,l)}if(s>0){o=document.createDocumentFragment();for(let n=0;n<s;n++){const i=t[r+n];e.insertFunc.call(this,e.createChildContext(i,r+n),o,a)}var u=a.bindArray[r-1];u[u.length-1].after(o)}}),e)}function ComponentBinder(e,t,n,r){var i=n(),s=t.mb.components[i.name];e.$context=t,e.insertFunc=s.insertFunc;var a=document.createDocumentFragment(),o=null==s.viewModel?t.$data:new s.viewModel(t.mb,i.params);o=t.mb.wrap(o);var l=new BindingContext(t.mb,o,0,t);e.insertFunc.call(o,l,a,e),e.appendChild(a)}function IfBinder(e,t){e._if=!1,e.bind(t,((t,n)=>{if(t&&!e._if){var r=document.createDocumentFragment();e.insertFunc.call(e.$data,e,r,e.element),e.element.appendChild(r),e.commitElement(),e._if=!0}else!t&&e._if&&(e.clearElement(0),e._if=!1)}))}class MicroBinder extends MicroBinderCore{constructor(){super();var e=this;this.components={register:function(t,n){return this[t]=n,this[t].insertFunc=e.build(n.template).then((e=>{this[t].insertFunc=e})),this[t].insertFunc}},this.funcGen=new FuncGenerator(this),this.binders={text:(e,t,n)=>this.bind(n,((t,n)=>e.innerText=t),t),html:(e,t,n)=>this.bind(n,((t,n)=>e.innerHTML=t),t),value:(e,t,n)=>{this.bind(n,((t,n)=>e.value=t||""),t),e.addEventListener("change",(e=>this.setValue(t,n,e.target.value)))},textInput:(e,t,n)=>{this.bind(n,((t,n)=>e.value=t||""),t),e.addEventListener("input",(e=>this.setValue(t,n,e.target.value)))},checked:(e,t,n)=>{this.bind(n,((t,n)=>{t?e.setAttribute("checked",""):e.removeAttribute("checked","")}),t),e.addEventListener("change",(e=>this.setValue(t,n,e.target.checked)))},hasFocus:(e,t,n)=>{this.bind(n,((t,n)=>t?e.focus():e.blur()),t),e.addEventListener("focus",(e=>this.setValue(t,n,!0))),e.addEventListener("blur",(e=>this.setValue(t,n,!1)))},class:(e,t,n)=>{n();this.bind(n,((t,n)=>{"string"==typeof n&&n.split(" ").forEach((t=>{""!=t&&e.classList.remove(t)})),t.split(" ").forEach((t=>{""!=t&&e.classList.add(t)}))}),t)},css:(e,t,n)=>{var r=n();if("string"==typeof r)this.bind(n,((t,n)=>{"string"==typeof n&&n.split(" ").forEach((t=>{""!=t&&e.classList.remove(t)})),t.split(" ").forEach((t=>{""!=t&&e.classList.add(t)}))}),t);else for(const n in r)this.bind(r[n],((t,r)=>t?e.classList.add(n):e.classList.remove(n)),t)},attr:(e,t,n)=>{var r=n();for(const n in r)this.bind(r[n],((t,r)=>e.setAttribute(n,t)),t)},prop:(e,t,n)=>{var r=n(),i=!1;for(const n in r)this.bind(r[n],((t,r)=>{e.proxy[n]!=t&&(i=!0,e.proxy[n]=t,i=!1)}),t);e.addEventListener("propchange",(e=>{null!=n()[e.name]&&0==i&&this.setValue(t,r[e.name],e.newValue)}))},props:(e,t,n)=>{var r=!1;this.bind(n,((t,n)=>{for(const t in n)this.bind(n,(()=>n[t]),((n,i)=>{e.proxy[t]!=n&&(r=!0,e.proxy[t]=n,r=!1)}))}),t),e.addEventListener("propchange",(e=>{var t=n();null!=t[e.name]&&0==r&&this.setValue(t,(()=>t[e.name]),e.newValue)}))},style:(e,t,n)=>{var r=n();for(const n in r)this.bind(r[n],((t,r)=>e.style[n]=t),t)},visible:(e,t,n)=>this.bind(n,((t,n)=>e.style.display=t?null:"none"),t),click:(e,t,n)=>e.addEventListener("click",(e=>n().call(t.$data,t.$data,e))),enter:(e,t,n)=>{e.addEventListener("keypress",(e=>{13===e.keyCode&&n()(t.$data,e)}))},submit:(e,t,n)=>e.addEventListener("submit",(e=>n()(t.$data,e))),if:IfBinder,with:(e,t,n,r)=>{e.insertFunc=this.funcGen.bindObjects[r],e.$context=t,this.bind(n,((n,r)=>{e.innerHTML="";var i=document.createDocumentFragment();e.insertFunc.call(n,new BindingContext(this,n,0,t),i,e),e.appendChild(i)}),t)},for:ForBinder,foreach:ForEachBinder,component:ComponentBinder,selectedOptions:(e,t,n)=>{this.bind(n,((t,n)=>{var r=t.map((e=>e.toString()));Array.from(e.options).forEach((e=>e.selected=r.indexOf(e.value)>-1))}),t),e.addEventListener("change",(e=>{var r=Array.from(e.target.selectedOptions).map((e=>e.value));this.setValue(t,n,r)}))},event:(e,t,n)=>{var r=n();for(const n in r){const i=r[n];e.addEventListener(n,(n=>i.call(t.$data,e,n)))}},enable:(e,t,n)=>{this.bind(n,((t,n)=>t?e.removeAttribute("disabled"):e.setAttribute("disabled","")),t)},disable:(e,t,n)=>{this.bind(n,((t,n)=>t?e.setAttribute("disabled",""):e.removeAttribute("disabled")),t)}},this.subBinders={if:1,with:1,foreach:1,for:1},this.bindObjects=[],this.bindObjectCount=-1}applyBindings(e,t,n){return this.build(n).then((n=>this.run(e,t||document.body,n)))}build(e){return new Promise(((t,n)=>{this.funcGen.generateRootInsertFunc(e).then((e=>{t(e)})).catch((e=>n(e)))}))}run(e,t,n){var r=this.wrap(e),i=new BindingContext(this,r);return n.call(this,i,t),r}executeBinding(e,t,n,r){e.$context=t,t.element=e,t.insertFunc=this.bindObjects[r];var i=!1;for(var s in n)i="foreach"==s||"for"==s||"if"==s?this.binders[s](t,n[s])|i:this.binders[s](e,t,n[s],r)|i;return i}setValue(e,t,n){this._settingValue=!0,this._setStack=[];t.call(e.$data);this._settingValue=!1,this._setStack.length>0&&this._setStack.pop()(n)}}export default MicroBinder;