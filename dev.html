<!DOCTYPE html>
<html lang="en">
    <head>
        <link href="data:image/x-icon;base64,AAABAAEAEBAQAAAAAAAoAQAAFgAAACgAAAAQAAAAIAAAAAEABAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEhEQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP7/AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA" rel="icon" type="image/x-icon" />
        <meta charset="utf-8"/>
        <link id="mdicontainer-template" href="/components/MDIContainer/MDIContainer.html" rel="preload" as="fetch" crossorigin="anonymous" />
    </head>
    <body>
        <style>
            .virtual{
                background: green;
            }
        </style>
        <template id="t1">
            <input type=text bind=firstName /> 
            <input type=text bind=lastName />
            <label bind=firstName></label>
            <label bind=lastName></label>

            <hr/>

            <ul bind=fruit>
                <li>
                    <section bind="{if:$parent.editItem != null && $data == $parent.editItem}">
                        <span type=text bind="{text: $index + ': '}"></span>
                        <input type=text bind="textInput:name,enter:()=>$parent.save()" />
                        <button bind="()=>$parent.save()">Done</button>
                    </section>
                    
                    <div bind="{if:!($parent.editItem != null && $data == $parent.editItem)}">
                        <span type=text bind="{text: $index + ': '}"></span>
                        <span bind=name></span>
                        <button bind="()=>test()">Test</button>
                        <button bind="()=>alert(name)">Alert Name</button>
                        <button bind="()=>$parent.edit(this)">Edit</button>
                        <!-- <button bind="click:$parent.edit">This Context Broken Edit</button>
                        <button bind="click:function(){$parent.edit($data)}">Edit3</button> -->

                        <button bind="()=>$parent.moveUp(this)">/\</button>
                        <button bind="()=>$parent.moveDown(this)">\/</button>

                        <button bind="()=>$parent.delete(this)">X</button>
                    </div>

                    <ul bind=types>
                        <span bind="{text: $data}"></span>
                        <span type=text bind="{text: $index + ': '}"></span>
                    </ul>
                </li>
            </ul>

            <hr/>
            <ul bind=fruit><li bind="$index + ' - ' + name"></li></ul>

        </template>

        <template id="mb-person-template">
            <input type=text bind=firstName /> 
            <input type=text bind=lastName />
            <label bind=firstName></label>
            <label bind=lastName></label>
        </template>

        <template id="t2">
            <input type="checkbox" bind="checked:toggle1" />
            <input type="checkbox" bind="checked:toggle2" />
            <input type="checkbox" bind="checked:toggle3" />
            <input type="checkbox" bind="checked:toggle4" />
            <input type="checkbox" bind="checked:toggle5" />
            <div bind="if:toggle1">Showing 1 Virtual Element</div>
            <div bind="if:toggle2">Showing 2 Virtual Element</div>
            <div bind="if:toggle3">Showing 3 Virtual Element</div>
            <div bind="if:toggle4">Showing 4 Virtual Element</div>
            <div bind="if:toggle5">Showing 5 Virtual Element</div>
            <div>
                <virtual bind="if:toggle1">
                    <div class="virtual">1 (Virtual)Element</div>
                </virtual>
                <div>First Element</div>
                <virtual bind="if:toggle2">
                    <div class="virtual">2 (Virtual)Element</div>
                </virtual>
                <virtual bind="if:toggle3">
                    <div class="virtual">3 (Virtual)Element</div>
                </virtual>
                <virtual bind="if:toggle4">
                    <div class="virtual">4 (Virtual)Element</div>
                </virtual>
                <div>Third Element</div>
                <virtual bind="if:toggle5">
                    <div class="virtual">5 (Virtual)Element</div>
                </virtual>
            </div>
            
        </template>

        <script type="module">
            import MicroBinder from './src2/mb.debug.js'
            var mb = new MicroBinder();

            class Person {
                constructor() {
                    this.firstName = 'Micro';
                    this.lastName = 'Binder';
                    this.fruit = [
                        {name:"Apple", types:["Pink Lady","Gala","Granny Smith"], test:function(){alert(this.name)}},
                        {name:"Pear", types:["Confrence","Golden"], test:()=>alert(this.name)},
                        {name:"Lemon", types:["Big", "Small"], test:()=>alert(this.name)},
                        {name:"Lime", types:["Big", "Small"], test:()=>alert(this.name)}
                    ];
                    this.editItem = null;
                    this.toggle1 = false;
                    this.toggle2 = false;
                    this.toggle3 = false;
                    this.toggle4 = false;
                    this.toggle5 = false;
                }

                edit(item){
                    this.editItem = item;
                }
                save(item){
                    this.editItem = null;
                }
                delete(item){
                    var index = this.fruit.indexOf(item);
                    this.fruit.splice(index, 1);
                }
                moveUp(item){
                    var index = this.fruit.indexOf(item);
                    if(index > 0){
                        this.fruit.splice(index, 1);
                        this.fruit.splice(index - 1, 0, item);
                    }
                }
                moveDown(item){
                    var index = this.fruit.indexOf(item);
                    if(index < this.fruit.length - 1){
                        this.fruit.splice(index, 1);
                        this.fruit.splice(index + 1, 0, item);
                    }
                }
            }
            mb.applyBindings(new Person(), document.body, 't2');

            //var dist = mb.build(new Person(), document.body, 't1');
            //debugger;
            //mb.run(new Person(), document.body, start);

        </script>

        
    </body>
</html>